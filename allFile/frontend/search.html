<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous" />

    <title>Search | Eventertainment</title>
    <!-- <link rel="stylesheet" href="search.css" /> -->
    <style>
        .app {
            overflow: hidden;
            position: fixed;
            /* Set the navbar to fixed position */
            top: 0;
            /* Position the navbar at the top of the page */
            width: 100%;
            /* Full width */
        }

        body {
            background: #ffffff;
            /* display: flex;
            align-items: center; */
            /* justify-content: center; */
            /* padding-top: 280px; */
        }

        #formrow {
            background-color: rgb(255, 231, 234);
            border-radius: 30px;
            box-shadow: 12px 12px 22px rgba(0, 0, 0, 0.1);
        }

        .btn {
            border: none;
            outline: none;
            background-color: black;
            color: white;
            border-radius: 4px;
            font-weight: bold;
        }

        .btn:hover {
            background-color: white;
            border: 1px solid black;
            color: black;
        }

        footer {
            position: fixed;
            left: 0;
            bottom: 0;
            width: 100%;
            /* text-align: center;
            position:absolute; */
            /* bottom:0; */
            /* width:100%; */
            /*Height of the footer */
        }
    </style>
</head>

<body>
    <!-- nav bar -->
    <div id="app">
        <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #e3f2fd;">
            <div class="container-fluid">
                <!-- Icono de NAVBAR -->
                <nav class="navbar navbar-light">
                    <div class="container-fluid">
                        <a class="navbar-brand" href="/Homepage">
                            <img src="https://raw.githubusercontent.com/gdoyssaga/our_WEPPRO/22030122c194d3ff5b6b6907587e2ac418aac53f/image/logo.svg"
                                alt="" style="width: 90px; height: 70px" class="d-inline-block align-top" />
                        </a>
                    </div>
                </nav>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a href="/Homepage" class="nav-link" aria-current="page">Events</a>
                    </li>
                    <li class="nav-item">
                        <a href="/aboutuspage" class="nav-link">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a href="/searchpage" class="nav-link">Search</a>
                    </li>
                    </ul>
                    <ul class="navbar-nav me-2 mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a href="/loginpage" class="nav-link" aria-current="page">Login</a>
                        </li>
                        <li class="nav-item">
                            <a href="/registerpage" class="nav-link" aria-current="page">Register</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
    <!-- Main -->
    <main class="pb-20">
        <div class="container pt-3">
            <div class="row pt-1 pb-1">
                <div class="col-lg-12">
                    <h4 class="text-center">Want to find the event?</h4>
                    <h6 class="text-center"></h6>
                </div>
            </div>
        </div>
        <section class="search-sec pt-3 ">
            <div class="container">
                <form action="#" method="GET">
                    <div class="row p-3" id="formrow">
                        <div class="col-lg-4 py-1 col-md-3 col-sm-12 px-1">
                            <input type="text" name="name" class="form-control search-slt" placeholder="Event name">
                        </div>
                        <div class="col-lg-2 py-1 col-md-3 col-sm-12 px-1">
                            <select class="form-control search-slt" name="month" placeholder="Event Drop City">
                                <option value="">Select Month</option>
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                        </div>
                        <div class="col-lg-2 py-1 col-md-3 col-sm-12 px-1">
                            <select class="form-control search-slt" name="city">
                                <option value="">Select Location</option>
                                <option value="Watthana">Watthana</option>
                                <option value="Ratchathewi">Ratchathewi</option>
                                <option value="Phayathai">Phayathai</option>
                                <option value="Pathumwan">Pathumwan</option>
                                <option value="Latphrao">Latphrao</option>
                                <option value="Bangna">Bangna</option>
                            </select>
                        </div>
                        <div class="col-lg-2 py-1 col-md-3 col-sm-12 px-1">
                            <select class="form-control search-slt" name="type">
                                <option value="">Select Event Type</option>
                                <option value="Concert">Concert</option>
                                <option value="E-sport">e-sport</option>
                                <option value="Comedy">comedy</option>
                                <option value="Art-design">art&design</option>
                            </select>
                        </div>
                        <div class="col-lg-1 py-1 col-md-3 col-sm-12 px-1">
                            <button type="submit" class="btn">Search</button>
                        </div>
                    </div>
                </form>
            </div>
        </section>
        <section class="container d-flex justify-content-center p-4 pt-5">
            <div class="row no-gutters" id="output"></div>
        </section>
    </main>

    <footer>
        <div class="text-center p-3" style="background-color: #e3f2fd; margin-top: 100px;">
            Â© 2020 Copyright:
            <a class="text-dark" href="/Homepage">Eventertainment.com</a>
        </div>
    </footer>
    <script src="https://unpkg.com/dayjs@1.8.21/dayjs.min.js"></script>
    <script>
        const searchParams = new URLSearchParams(window.location.search)
        console.log(searchParams.toString())
        
        const searchName = searchParams.get('name')
        console.log(searchName)

        const searchCity = searchParams.get('city')
        console.log(searchCity)

        const searchType = searchParams.get('type')
        console.log(searchType)

        const searchMonth = searchParams.get('month')
        console.log(searchMonth)

        const resultElem = document.getElementById('output')

        if (searchName) {
            console.log('Send search from name: ' + searchName)
            fetch(`http://localhost:3030/search?name=${searchName}&city=${searchCity}&type=${searchType}&month=${searchMonth}`)
                .then((c) => c.json())
                .then((d) => {
                    const result = d.result
                    if (result == "") {
                        resultElem.innerHTML = `<span><b>No Data</b></span><br />`
                    }
                    result.forEach((data) => {
                        //console.log(data)
                        resultElem.innerHTML +=
                            `<div class="col-5 p-5">
                        <img class="img-fluid" style="width: auto; height: auto;" alt="connot load picture" src="${data.imgURL}"></div>
                        <div class="col-7 pt-5">
                        <h5 class="card-title">${data.Eventname}</h5><br />
                        <span><b>Type: </b>${data.Eventtype}</span><br />
                        <span><b>Location: </b><i class="fas fa-map-marker-alt" style="color: #9e293b"></i> ${data.Location}</span><br />
                        <span><b>Date and Time: </b><i class="fas fa-calendar-day" style="color: #9e293b" ></i> ${dayjs(data.DATE_TIME).format("DD MMMM YYYY")} 
                            &nbsp<i class="fas fa-clock" style="color: #9e293b" ></i> ${dayjs(data.DATE_TIME).format("HH:MM")} </span><br /> 
                        <br /> <p>${data.Event_Description}"</p>
                        </div>`
                    })
                    resultElem.innerHTML += '</div></div>'
                })
                .catch(function (err) {
                    console.log('error : ' + err);
                })
        } else if (searchCity && searchCity != "") {
            console.log('Send search from city: ' + searchCity)
            fetch(`http://localhost:3030/search?city=${searchCity}&type=${searchType}&month=${searchMonth}`)
                .then((c) => c.json())
                .then((d) => {
                    const result = d.result
                    if (result == "") {
                        resultElem.innerHTML = `<span><b>No Data</b></span><br />`
                    }
                    result.forEach((data) => {
                        //console.log(data)
                        resultElem.innerHTML +=
                            `<div class="col-5 p-5">
                        <img class="img-fluid" style="width: auto; height: auto;" alt="connot load picture" src="${data.imgURL}"></div>
                        <div class="col-7 pt-5">
                        <h5 class="card-title">${data.Eventname}</h5><br />
                        <span><b>Type: </b>${data.Eventtype}</span><br />
                        <span><b>Location: </b><i class="fas fa-map-marker-alt" style="color: #9e293b"></i> ${data.Location}</span><br />
                        <span><b>Date and Time: </b><i class="fas fa-calendar-day" style="color: #9e293b" ></i> ${dayjs(data.DATE_TIME).format("DD MMMM YYYY")} 
                            &nbsp<i class="fas fa-clock" style="color: #9e293b" ></i> ${dayjs(data.DATE_TIME).format("HH:MM")} </span><br /> 
                        <br /> <p>${data.Event_Description}"</p>
                        </div>`
                    })
                    resultElem.innerHTML += '</div></div>'
                })
                .catch(function (err) {
                    console.log('error : ' + err);
                })
        } else if (searchType && searchType != "") {
            console.log('Send search from type: ' + searchType)
            fetch(`http://localhost:3030/search?type=${searchType}&month=${searchMonth}`)
                .then((c) => c.json())
                .then((d) => {
                    const result = d.result
                    if (result == "") {
                        resultElem.innerHTML = `<span><b>No Data</b></span><br />`
                    }
                    result.forEach((data) => {
                        //console.log(data)
                        resultElem.innerHTML +=
                            `<div class="col-5 p-5">
                        <img class="img-fluid" style="width: auto; height: auto;" alt="connot load picture" src="${data.imgURL}"></div>
                        <div class="col-7 pt-5">
                        <h5 class="card-title">${data.Eventname}</h5><br />
                        <span><b>Type: </b>${data.Eventtype}</span><br />
                        <span><b>Location: </b><i class="fas fa-map-marker-alt" style="color: #9e293b"></i> ${data.Location}</span><br />
                        <span><b>Date and Time: </b><i class="fas fa-calendar-day" style="color: #9e293b" ></i> ${dayjs(data.DATE_TIME).format("DD MMMM YYYY")} 
                            &nbsp<i class="fas fa-clock" style="color: #9e293b" ></i> ${dayjs(data.DATE_TIME).format("HH:MM")} </span><br />  
                        <br /> <p>${data.Event_Description}"</p>
                        </div>`
                    })
                    resultElem.innerHTML += '</div></div>'
                })
                .catch(function (err) {
                    console.log('error : ' + err);
                })
        } else if (searchMonth && searchMonth != "") {
            console.log('Send search from month: ' + searchMonth)
            fetch(`http://localhost:3030/search?month=${searchMonth}`)
                .then((c) => c.json())
                .then((d) => {
                    const result = d.result
                    if (result == "") {
                        resultElem.innerHTML = `<span><b>No Data</b></span><br />`
                    }
                    result.forEach((data) => {
                        //console.log(data)
                        resultElem.innerHTML +=
                            `<div class="col-5 p-5">
                        <img class="img-fluid" style="width: auto; height: auto;" alt="connot load picture" src="${data.imgURL}"></div>
                        <div class="col-7 pt-5">
                        <h5 class="card-title">${data.Eventname}</h5><br />
                        <span><b>Type: </b>${data.Eventtype}</span><br />
                        <span><b>Location: </b><i class="fas fa-map-marker-alt" style="color: #9e293b"></i> ${data.Location}</span><br />
                        <span><b>Date and Time: </b><i class="fas fa-calendar-day" style="color: #9e293b" ></i> ${dayjs(data.DATE_TIME).format("DD MMMM YYYY")} 
                            &nbsp<i class="fas fa-clock" style="color: #9e293b" ></i> ${dayjs(data.DATE_TIME).format("HH:MM")} </span><br /> 
                        <br /> <p>${data.Event_Description}"</p>
                        </div>`
                    })
                    resultElem.innerHTML += '</div></div>'
                })
                .catch(function (err) {
                    console.log('error : ' + err);
                })
        }
    </script>
    <!-- <script src="OUR_WEPPRO/backend/function.js" type="text/javascript"></script> -->
    <script src="https://kit.fontawesome.com/114906923e.js" crossorigin="anonymous"></script>
</body>

</html>